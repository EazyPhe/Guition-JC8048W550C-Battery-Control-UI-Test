# Guition-JC8048W550C-Battery-Control-UI-Test Project Documentation

## Overview

**Guition-JC8048W550C-Battery-Control-UI-Test** is a PlatformIO-based firmware project for the ESP32-S3 microcontroller, designed to drive an 800x480 RGB LCD panel (ST7262 controller) with capacitive touch (GT911) using the LVGL graphics library. The project supports both a simple demo UI and a more advanced UI generated by SquareLine Studio, leveraging LVGL 8.3.x for maximum compatibility.

---

## Hardware Platform

- **MCU:** ESP32-S3 (JC8048W550 board)
- **Display:** 800x480 RGB LCD (ST7262 controller)
- **Touch:** GT911 capacitive touch controller (I2C)
- **Backlight:** GPIO2 (active high)

---

## Software Stack

- **Framework:** Arduino (via PlatformIO)
- **Graphics Library:** LVGL 8.3.11
- **Touch Library:** TAMC_GT911
- **Custom UI:** Generated by SquareLine Studio (LVGL 8.x compatible)

---

## Project Structure

- `platformio.ini` — PlatformIO configuration, board, and library dependencies
- `src/` — Main source code
  - `main.cpp` — Main application logic, LVGL/touch setup, UI switching
  - `display_driver.cpp/.h` — LCD panel initialization and backlight control
  - `diagnostics.h` — System diagnostics and memory reporting
  - `ui_compat.h` — Compatibility helpers for SquareLine Studio UI
  - `ui/` — Auto-generated UI code from SquareLine Studio
- `include/lv_conf.h` — LVGL configuration (resolution, color depth, memory, etc.)
- `boards/` — Board JSONs for pinout and hardware config
- `sdkconfig*` — ESP-IDF/Arduino build and hardware settings

---

## Key Features & Flow

### 1. Initialization
- **Diagnostics:** Prints ESP32 chip info, heap/PSRAM stats, and LVGL version at startup.
- **Touch Controller:** Initializes GT911 via I2C (pins and address set in `main.cpp`).
- **LCD Panel:** Calls `lcd_panel_init()` (to be implemented in `display_driver.cpp`) to set up the ST7262 panel using ESP-IDF's RGB panel driver.
- **LVGL:**
  - Initializes LVGL and allocates a DMA-capable buffer for display drawing.
  - Registers display and input device drivers with LVGL, providing flush and touch callbacks.

### 2. UI Modes
- **Demo UI:** (Optional, see `create_simple_ui()` in `main.cpp`)
  - Shows a basic screen with a title, touch indicator, and a button to load the advanced UI.
- **SquareLine UI:**
  - Loads the UI generated by SquareLine Studio (see `src/ui/`).
  - UI screens and components are defined in C files, with event handlers and helpers.

### 3. LVGL Integration
- **Display Flush:**
  - `display_flush_cb()` is called by LVGL to push a region of pixels to the LCD using `esp_lcd_panel_draw_bitmap()`.
- **Touch Read:**
  - `touch_read_cb()` reads touch data from the GT911 and updates LVGL's input state.
  - Optionally updates a touch indicator on the screen.

### 4. Build & Configuration
- **LVGL Settings:**
  - Resolution, color depth, and memory settings are defined in `include/lv_conf.h`.
  - Custom memory allocators are used for ESP32 compatibility.
- **PlatformIO:**
  - Board, framework, and library dependencies are set in `platformio.ini`.
  - Build flags ensure correct LVGL and hardware configuration.
- **SDKConfig:**
  - ESP-IDF/Arduino settings for PSRAM, flash size, FreeRTOS, LCD, and touch are set in `sdkconfig.defaults` and `sdkconfig.JC8048W550`.

---

## UI Code (SquareLine Studio)
- All UI screens, components, and event handlers are auto-generated in `src/ui/`.
- Main entry point: `ui_init()` (see `ui.c`), which loads the default theme and screens.
- UI helpers and event stubs are provided for further customization.

---

## Extending the Project
- **To add new UI screens:** Use SquareLine Studio, export, and replace the contents of `src/ui/`.
- **To implement custom display drivers:** Complete the `lcd_panel_init()` and `lcd_backlight()` functions in `display_driver.cpp`.
- **To add new features:** Use the LVGL API in `main.cpp` or extend the SquareLine UI code.

---

## Troubleshooting
- **No display output:** Ensure `lcd_panel_init()` is implemented and the correct pins are set in the board JSON and `main.cpp`.
- **Touch not working:** Check GT911 wiring, I2C address, and pin assignments.
- **LVGL errors:** Confirm LVGL version and configuration match those required by SquareLine Studio (see `lv_conf.h`).

---

## References
- [LVGL Documentation](https://docs.lvgl.io/8.3/)
- [SquareLine Studio](https://squareline.io/)
- [ESP-IDF LCD RGB Panel](https://docs.espressif.com/projects/esp-idf/en/latest/esp32s3/api-reference/peripherals/lcd.html)
- [TAMC_GT911 Library](https://github.com/TAMCTec/TAMC_GT911)

---

*This documentation was auto-generated for the Display_Test project. For hardware-specific details, refer to your board's datasheet and the `boards/` directory.*
